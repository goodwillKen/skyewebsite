<!DOCTYPE html>
<html lang="en" data-theme="realist">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Skye | Grounded Intimacy | Equine Assisted Learning and Intimacy Coaching</title>
  <meta name="description" content="Grounded Intimacy: Equine Assisted Learning and intimacy coaching in Victoria, Australia. Experiential, somatic, and practical guidance, delivered under the Victorian General Code of Conduct." />
  <link rel="canonical" href="https://groundedintimacy.com.au/" />

  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* --- CORE THEME VARIABLES --- */
    :root {
      --primary-color: #2F4F4F;
      --secondary-color: #4F7942;
      --accent-color: #708090;
      --bg-color: #F0F2F5;
      --card-bg: #FFFFFF;
      --text-color: #1a1a1a;
      --muted-text: #555;
      --font-heading: 'Rockwell', 'Courier New', serif;
      --font-body: 'Helvetica Neue', Helvetica, Arial, sans-serif;
      --border-radius: 6px;
      --btn-padding: 12px 24px;
      --transition: all 0.35s ease;
      --hero-overlay: linear-gradient(rgba(47,79,79,0.72), rgba(47,79,79,0.45));
      --texture-opacity: 0.05;
    }

    [data-theme="rebel"] {
      --primary-color: #B7410E;
      --secondary-color: #1560BD;
      --accent-color: #D2691E;
      --bg-color: #FFF8DC;
      --card-bg: #FFFAF0;
      --text-color: #2b1d0e;
      --muted-text: #5c4033;
      --font-heading: 'Impact', 'Arial Black', sans-serif;
      --font-body: 'Verdana', sans-serif;
      --border-radius: 0px;
      --hero-overlay: linear-gradient(rgba(183,65,14,0.62), rgba(21,96,189,0.42));
      --texture-opacity: 0.08;
    }

    [data-theme="soft"] {
      --primary-color: #8FBC8F;
      --secondary-color: #D2B48C;
      --accent-color: #3D2B1F;
      --bg-color: #FAF9F6;
      --card-bg: #FFFFFF;
      --text-color: #4a4a4a;
      --muted-text: #777;
      --font-heading: 'Georgia', 'Times New Roman', serif;
      --font-body: 'Gill Sans', 'Gill Sans MT', sans-serif;
      --border-radius: 18px;
      --hero-overlay: linear-gradient(rgba(143,188,143,0.62), rgba(210,180,140,0.42));
      --texture-opacity: 0.02;
    }

    body {
      font-family: var(--font-body);
      background-color: var(--bg-color);
      color: var(--text-color);
      line-height: 1.65;
      transition: var(--transition);
    }

    h1, h2, h3, h4, h5 {
      font-family: var(--font-heading);
      color: var(--primary-color);
      transition: color 0.35s ease;
    }

    body::before {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: var(--texture-opacity);
      z-index: -1;
      pointer-events: none;
      background-image: url("data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 0h40v40H0V0zm20 20h20v20H20V20zM0 20h20v20H0V20z' fill='%23000000' fill-opacity='1' fill-rule='evenodd'/%3E%3C/svg%3E");
    }

    nav {
      background-color: var(--card-bg);
      border-bottom: 4px solid var(--secondary-color);
    }

    .theme-btn { opacity: 0.65; transition: 0.25s; white-space: nowrap; cursor: pointer; }
    .theme-btn.active { opacity: 1; transform: scale(1.04); font-weight: 700; color: var(--primary-color); border-bottom: 2px solid var(--primary-color); }

    .btn-primary {
      background-color: var(--primary-color);
      color: #fff;
      padding: var(--btn-padding);
      font-family: var(--font-heading);
      border-radius: var(--border-radius);
      transition: var(--transition);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      border: 2px solid var(--primary-color);
      cursor: pointer;
    }
    .btn-primary:hover { background-color: transparent; color: var(--primary-color); }

    .btn-outline {
      background-color: transparent;
      color: var(--primary-color);
      padding: var(--btn-padding);
      font-family: var(--font-heading);
      border-radius: var(--border-radius);
      transition: var(--transition);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      border: 2px solid var(--primary-color);
      display: inline-block;
      cursor: pointer;
    }
    .btn-outline:hover { background-color: var(--primary-color); color: #fff; }

    .hero-section {
      background-image: var(--hero-overlay), url('hero.jpg');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      background-color: #333;
    }

    /* Music Player */
    .music-bar { background: #141414; color: #fff; border-top: 1px solid rgba(255,255,255,0.1); }
    .vinyl-spin { animation: spin 6s linear infinite; }
    .vinyl-paused { animation-play-state: paused; opacity: 0.5; }
    @keyframes spin { 100% { transform: rotate(360deg); } }

    /* Cart Badge */
    .cart-badge {
      position: absolute; top: -8px; right: -8px;
      background: #B7410E; color: white;
      font-size: 0.7rem; font-weight: bold;
      width: 20px; height: 20px;
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
    }

    .feature-card {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      border-top: 5px solid var(--secondary-color);
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
      transition: transform 0.25s ease;
    }
    .feature-card:hover { transform: translateY(-4px); }

    input, select, textarea {
      border-radius: var(--border-radius);
      border: 2px solid #e5e7eb;
      font-family: var(--font-body);
    }
    input:focus, select:focus, textarea:focus { outline: none; border-color: var(--primary-color); }

    .horse-img-container {
      overflow: hidden; position: relative; width: 100%; height: clamp(260px, 35vw, 420px); background-color: #ddd;
    }
    .horse-img-container img {
      width: 100%; height: 100%; object-fit: cover; object-position: center; display: block; transition: transform 0.5s ease;
    }
    .horse-card:hover .horse-img-container img { transform: scale(1.03); }

    .modal-overlay { background-color: rgba(0,0,0,0.72); backdrop-filter: blur(4px); }
    
    #toast {
      visibility: hidden; min-width: 280px; background-color: var(--primary-color); color: #fff; text-align: center;
      border-radius: 6px; padding: 14px 16px; position: fixed; z-index: 100; left: 50%; bottom: 30px;
      transform: translateX(-50%); box-shadow: 0 6px 16px rgba(0,0,0,0.22); opacity: 0; transition: opacity 0.25s, bottom 0.25s;
    }
    #toast.show { visibility: visible; opacity: 1; bottom: 52px; }

    .compliance-pill {
      display: inline-flex; align-items: center; gap: 10px; background: rgba(255,255,255,0.75);
      border: 1px solid rgba(0,0,0,0.08); padding: 10px 14px; border-radius: 999px;
    }
    
    .link-subtle { color: inherit; text-decoration: underline; text-underline-offset: 3px; opacity: 0.85; }
    .link-subtle:hover { opacity: 1; }
  </style>
</head>

<body>
  <nav class="sticky top-0 z-50 py-4 shadow-sm transition-colors duration-300 relative">
    <div class="container mx-auto px-4 flex flex-wrap justify-between items-center gap-4">
      <div class="flex items-center gap-2 cursor-pointer" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
        <i class="fa-solid fa-horse-head text-2xl" style="color: var(--primary-color)"></i>
        <span class="text-2xl font-bold tracking-tight" style="font-family: var(--font-heading); color: var(--primary-color)">GROUNDED INTIMACY</span>
      </div>

      <div class="hidden lg:flex gap-6 font-semibold text-sm uppercase tracking-wider" style="color: var(--text-color)">
        <a href="#paddock" class="hover:opacity-75 transition">The Paddock</a>
        <a href="#room" class="hover:opacity-75 transition">The Room</a>
        <a href="#boutique" class="hover:opacity-75 transition">The Boutique</a>
        <a href="#safety" class="hover:opacity-75 transition">Safety</a>
        <a href="#contact" class="hover:opacity-75 transition">Book</a>
      </div>

      <div class="flex gap-4 text-sm bg-gray-100 px-4 py-2 rounded-full">
        <button class="theme-btn active" onclick="setTheme('realist')">High-Country</button>
        <button class="theme-btn" onclick="setTheme('rebel')">Red Dirt</button>
        <button class="theme-btn" onclick="setTheme('soft')">Soft Saddle</button>
      </div>

      <button class="relative p-2 text-gray-600 hover:text-gray-900" onclick="toggleModal('cart-modal')">
        <i class="fa-solid fa-cart-shopping text-xl"></i>
        <span id="cart-count" class="cart-badge hidden">0</span>
      </button>

      <button class="lg:hidden text-2xl focus:outline-none" onclick="toggleMobileNav()">
        <i class="fa-solid fa-bars"></i>
      </button>

      <div id="mobile-nav" class="hidden absolute top-full left-0 w-full bg-white shadow-md lg:hidden">
        <div class="flex flex-col divide-y text-sm uppercase tracking-wider" style="color: var(--text-color)">
          <a href="#paddock" onclick="toggleMobileNav()" class="px-6 py-4">The Paddock</a>
          <a href="#room" onclick="toggleMobileNav()" class="px-6 py-4">The Room</a>
          <a href="#boutique" onclick="toggleMobileNav()" class="px-6 py-4">The Boutique</a>
          <a href="#safety" onclick="toggleMobileNav()" class="px-6 py-4">Safety</a>
          <a href="#contact" onclick="toggleMobileNav()" class="px-6 py-4 font-bold">Book</a>
        </div>
      </div>
    </div>
  </nav>

  <header class="hero-section min-h-[82vh] flex items-center justify-center text-center text-white px-4 relative">
    <div class="max-w-4xl relative z-10">
      <div class="flex flex-wrap justify-center gap-3 mb-6">
        <span class="compliance-pill text-xs uppercase tracking-widest text-gray-900">
          <i class="fa-solid fa-shield-halved" style="color: var(--primary-color)"></i> General health service provider
        </span>
        <span class="compliance-pill text-xs uppercase tracking-widest text-gray-900">
          <i class="fa-solid fa-scroll" style="color: var(--primary-color)"></i> Victorian Code of Conduct
        </span>
      </div>

      <h1 id="hero-title" class="text-4xl md:text-6xl font-bold mb-6 drop-shadow-lg" style="color: #fff;">THE TRUTH IS IN THE PADDOCK.</h1>
      <p id="hero-subtitle" class="text-lg md:text-2xl mb-8 opacity-95 max-w-3xl mx-auto leading-relaxed">
        Equine Assisted Learning and intimacy coaching grounded in the reality of Victoria. Boots on. Noise off. Honest work.
      </p>

      <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
        <a href="#services" id="hero-btn" class="inline-block bg-white font-bold py-4 px-8 rounded shadow-lg hover:bg-gray-100 transition transform hover:scale-105" style="font-family: var(--font-heading); color: var(--primary-color)">Enter the Paddock</a>
        <a href="#compliance" class="inline-block btn-outline">Read the Disclosures</a>
      </div>
    </div>
  </header>

  <div class="music-bar py-3 px-4 sticky bottom-0 z-40 md:relative">
    <div class="container mx-auto flex items-center justify-between md:justify-center gap-4">
      <div class="flex items-center gap-3">
        <i id="vinyl-icon" class="fa-solid fa-compact-disc vinyl-paused text-2xl" style="color: var(--secondary-color)"></i>
        <div class="text-left">
          <span class="text-xs uppercase tracking-widest opacity-60 block">Soundtrack cue</span>
          <span id="current-track" class="text-sm md:text-lg tracking-wide">Now Playing: Sorrento Moon (I Remember) | Tina Arena</span>
        </div>
      </div>
      
      <button onclick="toggleAudio()" class="w-10 h-10 rounded-full bg-white text-black flex items-center justify-center hover:bg-gray-200 transition">
        <i id="play-icon" class="fa-solid fa-play ml-1"></i>
      </button>

      <div id="player-realist" class="absolute opacity-0 pointer-events-none"></div>
      <div id="player-rebel" class="absolute opacity-0 pointer-events-none"></div>
      <div id="player-soft" class="absolute opacity-0 pointer-events-none"></div>
    </div>
  </div>

  <section class="py-20 px-4" style="background-color: var(--bg-color)">
    <div class="container mx-auto max-w-5xl">
      <div class="bg-white p-8 md:p-12 rounded shadow-sm border-l-8 flex flex-col md:flex-row gap-8 items-center" style="border-color: var(--primary-color)">
        <div class="w-full md:w-1/3 flex-shrink-0">
          <img src="skye.jpg" alt="Skye" class="w-full h-auto rounded-lg shadow-md object-cover aspect-square" />
        </div>
        <div class="w-full md:w-2/3">
          <h2 class="text-3xl font-bold mb-6">Experiential authority. Practical, grounded, and real.</h2>
          <div class="text-lg space-y-4" style="color: var(--muted-text)">
            <p>I work at the intersection of Equine Assisted Learning, relationship education, and somatic practice. My approach is unpretentious and paddock-grounded.</p>
            <p>This is not clinical psychology. It is experiential guidance built around presence, boundaries, consent, and communication.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="py-20 px-4 bg-white" id="safety">
    <div class="container mx-auto max-w-4xl">
      <h2 class="text-3xl text-center mb-10">Safety first in the paddock</h2>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <div class="p-8 rounded shadow-sm" style="background-color: var(--bg-color)">
          <h3 class="text-xl mb-4">What to wear</h3>
          <ol class="list-decimal pl-6 space-y-2 text-sm" style="color: var(--muted-text)">
            <li>Closed-toe boots only. No open shoes in the paddock.</li>
            <li>Long pants recommended. Comfortable layers for weather changes.</li>
            <li>No loose scarves or dangling accessories around horses.</li>
          </ol>
        </div>

        <div class="p-8 rounded shadow-sm text-center" style="background-color: var(--bg-color)">
          <h3 class="text-xl mb-4">Core risk warning</h3>
          <p class="text-sm mb-4" style="color: var(--muted-text)">Horses are large and can be unpredictable. Risks include biting, kicking, trampling, and falling.</p>
          <a href="/documents/waiver.html" class="btn-outline">
              <i class="fa-solid fa-file-signature mr-2"></i> Sign Digital Waiver
          </a>
        </div>
      </div>
    </div>
  </section>

  <section class="py-20 px-4" style="background-color: var(--bg-color)" id="boutique">
    <div class="container mx-auto max-w-6xl">
        <div class="text-center mb-12">
            <h2 class="text-3xl md:text-4xl mb-4">Field-Tested Boutique</h2>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div class="feature-card p-6 flex flex-col">
                <h3 class="text-xl font-bold mb-2">The Workhorse</h3>
                <p class="text-sm text-gray-600 mb-4 flex-grow">Reliable, deep vibration. The 'Landcruiser' of the range.</p>
                <div class="flex justify-between items-center mt-auto">
                    <span class="font-bold text-lg">$149.00</span>
                    <button onclick="addToCart('The Workhorse', 149)" class="btn-primary text-xs py-2 px-4">Add to Kit</button>
                </div>
            </div>
            <div class="feature-card p-6 flex flex-col">
                <h3 class="text-xl font-bold mb-2">The Whisperer</h3>
                <p class="text-sm text-gray-600 mb-4 flex-grow">Quiet, broad stimulation for sensitive nervous systems.</p>
                <div class="flex justify-between items-center mt-auto">
                    <span class="font-bold text-lg">$129.00</span>
                    <button onclick="addToCart('The Whisperer', 129)" class="btn-primary text-xs py-2 px-4">Add to Kit</button>
                </div>
            </div>
            <div class="feature-card p-6 flex flex-col">
                <h3 class="text-xl font-bold mb-2">Essential Friction</h3>
                <p class="text-sm text-gray-600 mb-4 flex-grow">Organic, hybrid lubricant. No sticky residue.</p>
                <div class="flex justify-between items-center mt-auto">
                    <span class="font-bold text-lg">$29.00</span>
                    <button onclick="addToCart('Essential Friction', 29)" class="btn-primary text-xs py-2 px-4">Add to Kit</button>
                </div>
            </div>
        </div>
    </div>
  </section>

  <section class="py-20 px-4" id="contact" style="background-color: var(--bg-color)">
    <div class="container mx-auto">
      <div class="bg-white max-w-2xl mx-auto p-8 md:p-12 rounded shadow-lg border-t-8" style="border-color: var(--primary-color)">
        <h2 class="text-3xl font-bold mb-2">Open the farm gate</h2>
        <p class="mb-8" style="color: var(--muted-text)">Short intake. Clear consent. We start with what is true.</p>

        <form id="enquiryForm" class="space-y-6" onsubmit="submitForm(event)">
          <input type="hidden" id="themeInput" name="theme" value="realist">

          <div>
            <label class="block font-bold mb-2 text-sm uppercase">Name</label>
            <input type="text" name="name" class="w-full p-3 bg-gray-50" placeholder="Your name" required />
          </div>

          <div>
            <label class="block font-bold mb-2 text-sm uppercase">Email</label>
            <input type="email" name="email" class="w-full p-3 bg-gray-50" placeholder="you@example.com" required />
          </div>

          <div>
            <label class="block font-bold mb-2 text-sm uppercase">Service Interest</label>
            <select name="service" class="w-full p-3 bg-gray-50">
              <option>The Paddock (Equine Assisted Learning)</option>
              <option>The Room (Intimacy Coaching)</option>
              <option>The Full Experience</option>
              <option>Question about the Boutique</option>
            </select>
          </div>

          <div id="order-summary-box" class="hidden mb-6 bg-white p-4 border border-dashed border-gray-400 rounded">
            <h4 class="font-bold text-sm uppercase border-b pb-2 mb-2">Order Request</h4>
            <div id="order-items-list" class="text-sm space-y-1 mb-3"></div>
            <div class="text-right font-bold" id="order-total-display">Total: $0.00</div>
            <input type="hidden" name="orderData" id="orderDataInput">
          </div>

          <div>
            <label class="block font-bold mb-2 text-sm uppercase">What brings you here today?</label>
            <textarea name="message" class="w-full p-3 bg-gray-50 h-32" placeholder="No labels. Just the truth."></textarea>
          </div>

          <div class="border rounded p-4 bg-gray-50">
            <label class="flex items-start gap-3 cursor-pointer">
              <input id="consentSensitive" name="consentSensitive" type="checkbox" required />
              <span class="text-sm" style="color: var(--muted-text)">
                I consent to the collection of sensitive health information provided in this form for the purpose of assessing suitability.
              </span>
            </label>
          </div>

          <button type="submit" id="submit-btn" class="btn-primary w-full text-lg">Request a Session</button>
          <div id="form-feedback" class="hidden mt-4 text-center text-sm font-bold"></div>
        </form>
      </div>
    </div>
  </section>

  <footer class="bg-gray-900 text-gray-300 py-16 text-center px-4">
    <div class="container mx-auto max-w-4xl">
      <div id="footer-lyric" class="text-2xl text-white font-serif italic mb-8 opacity-90">"I remember... the way you used to be."</div>
      <p class="text-xs leading-relaxed opacity-80">Disclaimer: Skye is a general health service provider and follows the Victorian General Code of Conduct.</p>
    </div>
  </footer>

  <div id="cart-modal" class="fixed inset-0 z-[100] hidden bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center p-4">
    <div class="bg-white w-full max-w-md rounded shadow-2xl p-6">
        <h3 class="text-2xl font-bold mb-6">Your Kit</h3>
        <div id="cart-items" class="space-y-4 mb-6"></div>
        <div class="flex justify-between font-bold text-xl mb-6 border-t pt-4"><span>Total</span><span id="cart-total">$0.00</span></div>
        <button onclick="proceedToCheckout()" class="btn-primary w-full">Proceed to Intake</button>
    </div>
  </div>

  <div id="toast">Notification</div>

  <script src="https://www.youtube.com/iframe_api"></script>
  <script>
    const themeData = {
      realist: { trackTitle: "Now Playing: Sorrento Moon (I Remember) | Tina Arena", heroTitle: "THE TRUTH IS IN THE PADDOCK.", submitBtn: "Request a Session" },
      rebel: { trackTitle: "Now Playing: Chains | Tina Arena", heroTitle: "UNAPOLOGETIC. UNTAMED.", submitBtn: "Let's Get Real" },
      soft: { trackTitle: "Now Playing: Burn | Tina Arena", heroTitle: "A SOFT LANDING.", submitBtn: "Begin the Journey" }
    };

    const youtubeIDs = { realist: 'M0XgDxy2aXw', rebel: 'Fm52G3i5rUE', soft: 'w1f6o1udn7Q' };
    let players = {}, currentTheme = 'realist', isPlaying = false, cart = [];

    function onYouTubeIframeAPIReady() {
        ['realist', 'rebel', 'soft'].forEach(theme => {
            players[theme] = new YT.Player(`player-${theme}`, { videoId: youtubeIDs[theme], events: { 'onStateChange': (e) => { if(e.data === 0) resetAudioIcons(); } } });
        });
    }

    function toggleAudio() {
        const player = players[currentTheme];
        if (isPlaying) { player.pauseVideo(); isPlaying = false; } 
        else { Object.values(players).forEach(p => p.pauseVideo && p.pauseVideo()); player.playVideo(); isPlaying = true; }
        updateAudioIcons();
    }

    function updateAudioIcons() {
        document.getElementById('play-icon').classList.toggle('fa-pause', isPlaying);
        document.getElementById('play-icon').classList.toggle('fa-play', !isPlaying);
        document.getElementById('vinyl-icon').classList.toggle('vinyl-paused', !isPlaying);
    }

    function setTheme(themeName) {
      document.documentElement.setAttribute('data-theme', themeName);
      currentTheme = themeName;
      document.getElementById('hero-title').innerText = themeData[themeName].heroTitle;
      document.getElementById('current-track').innerText = themeData[themeName].trackTitle;
      document.getElementById('submit-btn').innerText = themeData[themeName].submitBtn;
      showToast(`Mode set: ${themeName}`);
    }

    function addToCart(name, price) {
        cart.push({ name, price });
        updateCartUI();
        toggleModal('cart-modal');
    }

    function updateCartUI() {
        const list = document.getElementById('cart-items');
        const total = cart.reduce((sum, item) => sum + item.price, 0);
        document.getElementById('cart-count').innerText = cart.length;
        document.getElementById('cart-count').classList.toggle('hidden', cart.length === 0);
        document.getElementById('cart-total').innerText = `$${total.toFixed(2)}`;
        list.innerHTML = cart.map(item => `<div class="flex justify-between"><span>${item.name}</span><span>$${item.price}</span></div>`).join('');
    }

    function proceedToCheckout() {
        toggleModal('cart-modal');
        document.getElementById('order-summary-box').classList.remove('hidden');
        document.getElementById('order-items-list').innerHTML = cart.map(item => `<div>â€¢ ${item.name} ($${item.price})</div>`).join('');
        document.getElementById('orderDataInput').value = JSON.stringify(cart);
        document.getElementById('contact').scrollIntoView({ behavior: 'smooth' });
    }

    async function submitForm(e) {
        e.preventDefault();
        const form = e.target;
        const btn = document.getElementById('submit-btn');
        const feedback = document.getElementById('form-feedback');
        const email = form.email.value;

        btn.disabled = true;
        btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin mr-2"></i> Verifying...';

        try {
            // 1. Mandatory Waiver Check
            const waiverRes = await fetch(`/api/check-waiver?email=${encodeURIComponent(email)}`);
            const waiverData = await waiverRes.json();
            
            if (!waiverData.signed) {
                showToast("Waiver required.");
                feedback.innerText = "Please sign the digital waiver in the 'Safety' section first.";
                feedback.className = "mt-4 text-center text-sm font-bold text-orange-600";
                feedback.classList.remove('hidden');
                return;
            }

            // 2. Submit Lead
            btn.innerHTML = 'Sending via Secure Tunnel...';
            const payload = Object.fromEntries(new FormData(form).entries());
            payload.consentSensitive = true;

            const res = await fetch('/api/submit-enquiry', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
            
            const result = await res.json();
            if(res.ok) {
                feedback.innerText = "Success! Check your Gmail.";
                feedback.className = "text-green-600 font-bold mt-4";
                form.reset();
            } else if (res.status === 429) {
                throw new Error(result.error);
            } else { throw new Error("Submission failed."); }

        } catch(err) {
            feedback.innerText = err.message;
            feedback.className = "text-red-600 font-bold mt-4";
        } finally {
            feedback.classList.remove('hidden');
            btn.disabled = false;
            btn.innerHTML = 'Request a Session';
        }
    }

    function toggleMobileNav() { document.getElementById('mobile-nav').classList.toggle('hidden'); }
    function toggleModal(id) { document.getElementById(id).classList.toggle('hidden'); }
    function showToast(msg) { const t = document.getElementById('toast'); t.innerText = msg; t.className = 'show'; setTimeout(() => t.className = '', 2600); }
  </script>
</body>
</html>